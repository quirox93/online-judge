---
const req = Astro.request;
---

<script is:inline>
async function parseMagicLink(req) {
    const vals = window.location.hash
        .substring(1)
        .split("&")
        .map((kv) => kv.split("="));
    const hashParameters = new Map(vals);
    const token = JSON.stringify(Object.fromEntries(hashParameters));
    localStorage.setItem("supabase.auth.token", token);
    window.location.replace("/");
}
parseMagicLink();
</script>
